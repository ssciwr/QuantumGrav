
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../training_a_model/">
      
      
        <link rel="next" href="../api/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Hyperparameter Tuning - QuantumGrav Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
      
  
  
    
      
      
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M12%202C6.47%202%202%206.47%202%2012s4.47%2010%2010%2010%2010-4.47%2010-10S17.53%202%2012%202m3.1%205.07c.14%200%20.28.05.4.16l1.27%201.27c.23.22.23.57%200%20.78l-1%201-2.05-2.05%201-1c.1-.11.24-.16.38-.16m-1.97%201.74%202.06%202.06-6.06%206.06H7.07v-2.06z%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hyperparameter-optimization" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="QuantumGrav Documentation" class="md-header__button md-logo" aria-label="QuantumGrav Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QuantumGrav Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Hyperparameter Tuning
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../getting_started/" class="md-tabs__link">
        
  
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../datasets_and_preprocessing/" class="md-tabs__link">
        
  
  
    
  
  Datasets and Preprocessing

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../models/" class="md-tabs__link">
        
  
  
    
  
  Graph Neural Network models

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../training_a_model/" class="md-tabs__link">
        
  
  
    
  
  Model Training

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  Hyperparameter Tuning

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../api/" class="md-tabs__link">
        
  
  
    
  
  API documentation

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../license/" class="md-tabs__link">
        
  
  
    
  
  License

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="QuantumGrav Documentation" class="md-nav__button md-logo" aria-label="QuantumGrav Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    QuantumGrav Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets_and_preprocessing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Datasets and Preprocessing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Graph Neural Network models
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../training_a_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Training
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Hyperparameter Tuning
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Hyperparameter Tuning
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#config-handling-with-custom-yaml-tags" class="md-nav__link">
    <span class="md-ellipsis">
      
        Config handling with custom YAML tags
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Config handling with custom YAML tags">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#confighandler-class" class="md-nav__link">
    <span class="md-ellipsis">
      
        ConfigHandler class
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimization-with-optuna" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optimization with Optuna
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Optimization with Optuna">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#define-an-optuna-search-space-using-qgtune" class="md-nav__link">
    <span class="md-ellipsis">
      
        Define an Optuna search space using QGTune
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Define an Optuna search space using QGTune">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optuna-suggestion-with-custom-yaml-tag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optuna suggestion with custom YAML tag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-optuna-search-space-from-a-modeltrainer-config-file" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create Optuna search space from a model/trainer config file
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-an-optuna-study" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create an Optuna study
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save-the-best-config-to-a-yaml-file" class="md-nav__link">
    <span class="md-ellipsis">
      
        Save the best config to a YAML file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#an-example-of-tuning-with-qgtune" class="md-nav__link">
    <span class="md-ellipsis">
      
        An example of tuning with QGTune
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="An example of tuning with QGTune">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-explanation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example explanation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example code
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-result" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example result
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notes-on-pruner-and-parallelization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notes on pruner and parallelization
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API documentation
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    License
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#config-handling-with-custom-yaml-tags" class="md-nav__link">
    <span class="md-ellipsis">
      
        Config handling with custom YAML tags
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Config handling with custom YAML tags">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#confighandler-class" class="md-nav__link">
    <span class="md-ellipsis">
      
        ConfigHandler class
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optimization-with-optuna" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optimization with Optuna
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Optimization with Optuna">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#define-an-optuna-search-space-using-qgtune" class="md-nav__link">
    <span class="md-ellipsis">
      
        Define an Optuna search space using QGTune
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Define an Optuna search space using QGTune">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optuna-suggestion-with-custom-yaml-tag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optuna suggestion with custom YAML tag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-optuna-search-space-from-a-modeltrainer-config-file" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create Optuna search space from a model/trainer config file
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-an-optuna-study" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create an Optuna study
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save-the-best-config-to-a-yaml-file" class="md-nav__link">
    <span class="md-ellipsis">
      
        Save the best config to a YAML file
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#an-example-of-tuning-with-qgtune" class="md-nav__link">
    <span class="md-ellipsis">
      
        An example of tuning with QGTune
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="An example of tuning with QGTune">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-explanation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example explanation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example code
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-result" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example result
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notes-on-pruner-and-parallelization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notes on pruner and parallelization
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="hyperparameter-optimization">Hyperparameter Optimization</h1>
<p>The <code>QuantumGrav</code> Python package lets users customize hyperparameters when building, training, validating, and testing GNN models. Choosing the right values is crucial for model performance.</p>
<p>To accelerate this process, we developed two ways to handle possible values of hyperparameters:</p>
<ul>
<li>Using custom YAML tags to generate a list of configs based on the cartesian product of possible values of hyperparameters, then run training on each config.<ul>
<li>Pros: Fully deterministic, exhaustive, simple, transparent</li>
<li>Cons: Explodes combinatorially, no guided search</li>
<li>Useful if:<ul>
<li>Our search space is small.</li>
<li>We need absolute transparency and determinism.</li>
<li>We are debugging or doing systematic experiments.</li>
<li>We want full coverage of combinations.</li>
<li>We avoid extra dependencies or complexity.</li>
</ul>
</li>
</ul>
</li>
<li>Using <a href="https://optuna.readthedocs.io/en/stable/index.html">Optuna</a> to create hyperparameter search space on a config file then automatically find optimal hyperparameter values for specific objectives (e.g. minimizing loss or maximizing accuracy).<ul>
<li>Pros: Support of intelligent search and pruning algorithms, visualization (when using with database), scalable running</li>
<li>Cons: Stochastic sampling, less exhaustive, more complex as we need to integrate the training loop into Optuna's objective function</li>
<li>Useful if:<ul>
<li>The search space is moderately large or huge.</li>
<li>We want efficient, guided optimization.</li>
<li>We need early stopping for poor configs.</li>
<li>We run on clusters or need parallel trials.</li>
<li>We want good results with limited compute budget.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="config-handling-with-custom-yaml-tags">Config handling with custom YAML tags</h2>
<p>We developed the following custom YAML tags to specify possible values of hyperparamters:</p>
<ul>
<li>
<p><code>!sweep</code> tag: Used to define possible categorical values for a hyperparameter. For example, if we want to experiment with two different values for the number of epochs (32 and 64), we can specify them as follows:
    <div class="language-yaml highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nt">training</span><span class="p">:</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">epochs</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="kt">!sweep</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">        </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">32</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">64</span><span class="p p-Indicator">]</span>
</span></code></pre></div></p>
</li>
<li>
<p><code>!coupled-sweep</code> tag: If a hyperparameter’s values depend on another sweep hyperparameter, we can use coupled-sweep to link them. For example, if we want the batch size to be 64 when training for 32 epochs and 128 when training for 64 epochs, we can specify the batch size as follows:
    <div class="language-yaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nt">training</span><span class="p">:</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">batch_size</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="kt">!coupled-sweep</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">training.epochs</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">        </span><span class="nt">values</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">64</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">128</span><span class="p p-Indicator">]</span>
</span></code></pre></div></p>
</li>
<li>
<p><code>!range</code> tag: If a hyperparameter takes values within an int or float range, the range can be specified as below:
    <div class="language-yaml highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nt">epochs</span><span class="p">:</span><span class="w"> </span><span class="kt">!range</span><span class="w"> </span><span class="c1"># int range</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">    </span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">    </span><span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="nt">step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="nt">drop_rate</span><span class="p">:</span><span class="w"> </span><span class="kt">!range</span><span class="w"> </span><span class="c1"># float range</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">    </span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.1</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">    </span><span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.5</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">    </span><span class="nt">step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.2</span>
</span></code></pre></div>
    <strong>Note: The stop value is included.</strong></p>
</li>
<li>
<p><code>!random_uniform</code> tag: This tag generates a set of float values uniformly sampled from a specified range. We can define the <code>size</code> (the number of values to produce); if not provided, it defaults to 5. When <code>log=True</code>, values are sampled in the log domain; otherwise, they are sampled linearly.
    <div class="language-yaml highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="kt">!random_uniform</span><span class="w"> </span><span class="c1"># float values in log domain</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1e-5</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span><span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1e-2</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span><span class="nt">log</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7</span>
</span></code></pre></div></p>
</li>
<li>
<p><code>!reference</code> tag: In some cases, a hyperparameter must share the same value as another. For instance, the input dimension of one layer and the output dimension of the previous layer. The <code>!reference</code> tag handles such cases:
    <div class="language-yaml highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nt">model</span><span class="p">:</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">    </span><span class="nt">layers</span><span class="p">:</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">        </span><span class="p p-Indicator">-</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">            </span><span class="nt">in_dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">728</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">            </span><span class="nt">out_dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">64</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">        </span><span class="p p-Indicator">-</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">            </span><span class="nt">in_dim</span><span class="p">:</span><span class="w"> </span><span class="kt">!reference</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">                </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">model.layers[0].out_dim</span>
</span></code></pre></div></p>
</li>
<li>
<p><code>!pyobject</code> tag: Ultimately, to specify a Python object in the config file, we use the <code>!pyobject</code> tag. This is useful for assigning a Python object to a model or layer type. For example:
    <div class="language-yaml highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nt">model</span><span class="p">:</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span><span class="nt">conv_layer</span><span class="p">:</span><span class="w"> </span><span class="kt">!pyobject</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">torch_geometric.nn.conv.sage_conv.SAGEConv</span>
</span></code></pre></div></p>
</li>
</ul>
<h3 id="confighandler-class">ConfigHandler class</h3>
<p>TODO: brief explanation.</p>
<h2 id="optimization-with-optuna">Optimization with Optuna</h2>
<p>The second option for finding optimal hyperparameter values is to use Optuna together with the custom YAML tag.</p>
<p>We developed a subpackage <code>QGTune</code> to convert a config file with custom YAML tags to hyperparameter search space for Optuna. Main purpose of the GQTune subpackage includes:</p>
<ul>
<li>Build Optuna search space from a model/trainer config YAML file (with above custom tags)</li>
<li>Create an Optuna study from a tuning config file (preferably YAML file)</li>
<li>Save the best config with optimal hyperparameter values back to a YAML file.</li>
</ul>
<h3 id="define-an-optuna-search-space-using-qgtune">Define an Optuna search space using QGTune</h3>
<h4 id="optuna-suggestion-with-custom-yaml-tag">Optuna suggestion with custom YAML tag</h4>
<p>Optuna use <a href="https://optuna.readthedocs.io/en/stable/reference/generated/optuna.trial.Trial.html">optuna.trial.Trial</a> to define hyperparameter search space for each study. Main functions include:</p>
<ul>
<li><code>suggest_categorical()</code>: suggest a value for a categorical parameter, which is a list of <code>bool</code>, <code>string</code>, <code>float</code>, or <code>int</code></li>
<li><code>suggest_float()</code>: suggest a value within a range for a floating point parameter, in linear or log domain</li>
<li><code>suggest_int()</code>: suggest a value within a range for an integer parameter</li>
</ul>
<p>The first suggestion function corresponds to the <code>!sweep</code> tag described above, while <code>suggest_int()</code> maps to the <code>!range</code> tag (when <code>start</code>, <code>stop</code>, and <code>step</code> are all integers). Float suggestions are handled through the <code>!range</code> and <code>!random_uniform</code> tags.</p>
<p>For example, the following configuration:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nt">epochs</span><span class="p">:</span><span class="w"> </span><span class="kt">!range</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span><span class="nt">step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span></code></pre></div>
<p>is equivalent to calling <code>optuna.trial.Trial.suggest_int(param_name, start, stop, step)</code>. </p>
<p>Here, <code>param_name</code> represents the parameter name stored in the Optuna study. We define this name as the path from the root node to the current node in the configuration file, e.g. <code>training.epochs</code> or <code>model.layer.0.in_dim</code>. Note that in this naming scheme, all parts are separated by dots (<code>.</code>). Unlike the <code>target</code> field in the <code>!reference</code> tag, no square brackets (<code>[]</code>) are used.</p>
<h4 id="create-optuna-search-space-from-a-modeltrainer-config-file">Create Optuna search space from a model/trainer config file</h4>
<p>To build an Optuna search space with <code>QGTune</code>, we can use <code>build_search_space()</code> function as in the following example:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">QuantumGrav.QGTune</span><span class="w"> </span><span class="kn">import</span> <span class="n">tune</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">trial</span><span class="o">.</span><span class="n">Trial</span><span class="p">,</span> <span class="n">config_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>    <span class="n">search_space</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">build_search_space</span><span class="p">(</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>        <span class="n">config_file</span><span class="o">=</span><span class="n">config_file</span><span class="p">,</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>        <span class="n">trial</span><span class="o">=</span><span class="n">trial</span><span class="p">,</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>    <span class="p">)</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>  <span class="o">...</span>
</span></code></pre></div>
<ul>
<li><code>objective</code> is the function that will be used later by an Optuna study for optimization</li>
<li><code>trial</code> is an object of <code>optuna.trial.Trial</code>, representing trials of an Optuna study</li>
<li><code>config_file</code> is path to the model/trainer configuration file (see <a href="../training_a_model/#the-configuration-dict">the configuration <code>dict</code></a> for an example)</li>
<li>
<p><code>search_space</code> is a dictionary constructed from the model/trainer config file, where values of hyperparameters defined with custom YAML tags are replaced by their corresponding Optuna trial suggestions. For example, the <code>epochs</code> configuration shown earlier would be transformed into:
    <div class="language-yaml highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nt">training</span><span class="p">:</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">    </span><span class="nt">epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">optuna.trial.Trial.suggest_int(&quot;training.epochs&quot;, start, stop, step)</span>
</span></code></pre></div></p>
<p>Subsequently, this <code>search_space</code> dictionary would be used for creating a GNN model and training the model as described in <a href="../training_a_model/#the-trainer-class">The Trainer class</a>.</p>
</li>
</ul>
<h3 id="create-an-optuna-study">Create an Optuna study</h3>
<p>The input for creating an Optuna study is a tuning configuration dictionary that should include essential keys like <code>"storage"</code>, <code>"study_name"</code>, and <code>"direction"</code>, for example:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="p">{</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>  <span class="s2">&quot;study_name&quot;</span><span class="p">:</span> <span class="s2">&quot;quantum_grav_study&quot;</span><span class="p">,</span> <span class="c1"># name of the Optuna study</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>  <span class="s2">&quot;storage&quot;</span><span class="p">:</span> <span class="s2">&quot;experiments/results.log&quot;</span><span class="p">,</span> <span class="c1"># only supports JournalStorage for multi-processing</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>  <span class="s2">&quot;direction&quot;</span><span class="p">:</span> <span class="s2">&quot;minimize&quot;</span> <span class="c1"># direction of optimization (&quot;minimize&quot; or &quot;maximize&quot;)</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="p">}</span>
</span></code></pre></div>
<p>If <code>storage</code> is assigned to <code>None</code> (or <code>null</code> in YAML file), the study will be saved with <code>optuna.storages.InMemoryStorage</code>, i.e. in RAM only until the Python session ends.</p>
<p>For simplicity while working with multi-processing, we only support storage with <a href="https://optuna.readthedocs.io/en/stable/reference/generated/optuna.storages.JournalStorage.html">Optuna's JournalStorage</a>.</p>
<h3 id="save-the-best-config-to-a-yaml-file">Save the best config to a YAML file</h3>
<p>After completing all trials, the hyperparameter values from the best trial, along with other fixed parameters, can be saved to a YAML file using the <code>save_best_config()</code> function.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_best_config</span><span class="p">(</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>    <span class="n">config_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>    <span class="n">best_trial</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">trial</span><span class="o">.</span><span class="n">FrozenTrial</span><span class="p">,</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>    <span class="n">output_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="p">):</span>
</span></code></pre></div>
<ul>
<li><code>config_file</code> is the path to the model/trainer configuration file</li>
<li><code>best_trial</code> is the trial with the optimal results, obtained from an Optuna study.</li>
<li><code>output_file</code> is the path to the YAML output file</li>
</ul>
<h3 id="an-example-of-tuning-with-qgtune">An example of tuning with QGTune</h3>
<p>We present here an example to demonstrate the functionality of <code>QGTune</code>.</p>
<h4 id="example-explanation">Example explanation</h4>
<p>In this example, we would:</p>
<ul>
<li>create sample configuration files for tuning and model/trainer settings</li>
<li>define a small model based on <a href="https://github.com/optuna/optuna-examples/blob/main/pytorch/pytorch_simple.py">Optuna's PyTorch example</a>.</li>
<li>load dat from <a href="https://github.com/zalandoresearch/fashion-mnist">Fashion-MNIST</a> dataset. </li>
<li>
<p>define the Optuna <code>objective</code> function.</p>
<ul>
<li>The task is to classify each 28×28 grayscale image into one of 10 fashion categories, such as T-shirt, coat, or sneaker.</li>
<li>To enable Optuna to monitor training progress, <code>trial.report()</code> should be called after each epoch to record the metric being optimized. In this example, we use <code>accuracy</code>.</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">trial</span><span class="o">.</span><span class="n">Trial</span><span class="p">,</span> <span class="n">config_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>  <span class="o">...</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>  <span class="n">search_space</span> <span class="o">=</span> <span class="o">...</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>  <span class="o">...</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>  <span class="c1"># prepare model</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>  <span class="o">...</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>  <span class="c1"># prepare optimizer</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>  <span class="o">...</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>  <span class="c1"># prepare data</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>  <span class="o">...</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>  <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>    <span class="c1"># train the model</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>    <span class="o">...</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>    <span class="c1"># validate the model</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>    <span class="o">...</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>    <span class="n">accuracy</span> <span class="o">=</span> <span class="o">...</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>    <span class="n">trial</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">epoch</span><span class="p">)</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>    <span class="k">if</span> <span class="n">trial</span><span class="o">.</span><span class="n">should_prune</span><span class="p">():</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a>        <span class="k">raise</span> <span class="n">optuna</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">TrialPruned</span><span class="p">()</span>
</span></code></pre></div>
</li>
<li>
<p>run the optimization process for a specified number of trials (<code>n_trials</code>)</p>
</li>
<li>use Optuna's <a href="https://optuna.readthedocs.io/en/stable/tutorial/10_key_features/004_distributed.html#multi-process-optimization">multi-process optimization</a> by setting the number of iterations (<code>n_iterations</code>) and processes (<code>n_processes</code>).</li>
</ul>
<h4 id="example-code">Example code</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># tune_example.py</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># make sure no GPU is used</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">QuantumGrav.QGTune</span><span class="w"> </span><span class="kn">import</span> <span class="n">tune</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">optuna</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">torchvision</span><span class="w"> </span><span class="kn">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">transforms</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">multiprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pool</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="kn">from</span><span class="w"> </span><span class="nn">optuna.storages.journal</span><span class="w"> </span><span class="kn">import</span> <span class="n">JournalStorage</span><span class="p">,</span> <span class="n">JournalFileBackend</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="n">DEVICE</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="n">current_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">current_dir</span> <span class="o">/</span> <span class="s2">&quot;tmp&quot;</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_tuning_config_file</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a tuning configuration YAML file for testing purposes.&quot;&quot;&quot;</span>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a>    <span class="c1"># Note on n_jobs: Multi-thread optimization has traditionally been inefficient</span>
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a>    <span class="c1"># in Python due to the Global Interpreter Lock (GIL) (Python &lt; 3.14)</span>
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a>    <span class="n">tuning_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a>        <span class="s2">&quot;config_file&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">tmp_path</span> <span class="o">/</span> <span class="s2">&quot;config.yaml&quot;</span><span class="p">),</span>
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a>        <span class="s2">&quot;study_name&quot;</span><span class="p">:</span> <span class="s2">&quot;test_study&quot;</span><span class="p">,</span>
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a>        <span class="s2">&quot;storage&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">tmp_path</span> <span class="o">/</span> <span class="s2">&quot;test_study.log&quot;</span><span class="p">),</span>
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a>        <span class="s2">&quot;direction&quot;</span><span class="p">:</span> <span class="s2">&quot;maximize&quot;</span><span class="p">,</span>
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a>        <span class="s2">&quot;n_trials&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
</span><span id="__span-12-34"><a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a>        <span class="s2">&quot;timeout&quot;</span><span class="p">:</span> <span class="mi">600</span><span class="p">,</span>
</span><span id="__span-12-35"><a id="__codelineno-12-35" name="__codelineno-12-35" href="#__codelineno-12-35"></a>        <span class="s2">&quot;n_jobs&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># set to &gt;1 to enable multi-threading,</span>
</span><span id="__span-12-36"><a id="__codelineno-12-36" name="__codelineno-12-36" href="#__codelineno-12-36"></a>        <span class="s2">&quot;best_config_file&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">tmp_path</span> <span class="o">/</span> <span class="s2">&quot;best_config.yaml&quot;</span><span class="p">),</span>
</span><span id="__span-12-37"><a id="__codelineno-12-37" name="__codelineno-12-37" href="#__codelineno-12-37"></a>        <span class="s2">&quot;n_processes&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="__span-12-38"><a id="__codelineno-12-38" name="__codelineno-12-38" href="#__codelineno-12-38"></a>        <span class="s2">&quot;n_iterations&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="__span-12-39"><a id="__codelineno-12-39" name="__codelineno-12-39" href="#__codelineno-12-39"></a>    <span class="p">}</span>
</span><span id="__span-12-40"><a id="__codelineno-12-40" name="__codelineno-12-40" href="#__codelineno-12-40"></a>    <span class="n">tuning_config_file</span> <span class="o">=</span> <span class="n">tmp_path</span> <span class="o">/</span> <span class="s2">&quot;tuning_config.yaml&quot;</span>
</span><span id="__span-12-41"><a id="__codelineno-12-41" name="__codelineno-12-41" href="#__codelineno-12-41"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">tuning_config_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-12-42"><a id="__codelineno-12-42" name="__codelineno-12-42" href="#__codelineno-12-42"></a>        <span class="n">yaml</span><span class="o">.</span><span class="n">safe_dump</span><span class="p">(</span><span class="n">tuning_config</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="__span-12-43"><a id="__codelineno-12-43" name="__codelineno-12-43" href="#__codelineno-12-43"></a>
</span><span id="__span-12-44"><a id="__codelineno-12-44" name="__codelineno-12-44" href="#__codelineno-12-44"></a>    <span class="k">return</span> <span class="n">tuning_config_file</span>
</span><span id="__span-12-45"><a id="__codelineno-12-45" name="__codelineno-12-45" href="#__codelineno-12-45"></a>
</span><span id="__span-12-46"><a id="__codelineno-12-46" name="__codelineno-12-46" href="#__codelineno-12-46"></a>
</span><span id="__span-12-47"><a id="__codelineno-12-47" name="__codelineno-12-47" href="#__codelineno-12-47"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_config_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
</span><span id="__span-12-48"><a id="__codelineno-12-48" name="__codelineno-12-48" href="#__codelineno-12-48"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a base configuration YAML file with tuning parameters for testing purposes.&quot;&quot;&quot;</span>
</span><span id="__span-12-49"><a id="__codelineno-12-49" name="__codelineno-12-49" href="#__codelineno-12-49"></a>    <span class="n">yaml_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-12-50"><a id="__codelineno-12-50" name="__codelineno-12-50" href="#__codelineno-12-50"></a><span class="s2">        model:</span>
</span><span id="__span-12-51"><a id="__codelineno-12-51" name="__codelineno-12-51" href="#__codelineno-12-51"></a><span class="s2">            n_layers: 3</span>
</span><span id="__span-12-52"><a id="__codelineno-12-52" name="__codelineno-12-52" href="#__codelineno-12-52"></a><span class="s2">            nn:</span>
</span><span id="__span-12-53"><a id="__codelineno-12-53" name="__codelineno-12-53" href="#__codelineno-12-53"></a><span class="s2">                -</span>
</span><span id="__span-12-54"><a id="__codelineno-12-54" name="__codelineno-12-54" href="#__codelineno-12-54"></a><span class="s2">                    in_dim: 784</span>
</span><span id="__span-12-55"><a id="__codelineno-12-55" name="__codelineno-12-55" href="#__codelineno-12-55"></a><span class="s2">                    out_dim: !sweep</span>
</span><span id="__span-12-56"><a id="__codelineno-12-56" name="__codelineno-12-56" href="#__codelineno-12-56"></a><span class="s2">                        values: [128, 256]</span>
</span><span id="__span-12-57"><a id="__codelineno-12-57" name="__codelineno-12-57" href="#__codelineno-12-57"></a><span class="s2">                    dropout: !range</span>
</span><span id="__span-12-58"><a id="__codelineno-12-58" name="__codelineno-12-58" href="#__codelineno-12-58"></a><span class="s2">                        start: 0.2</span>
</span><span id="__span-12-59"><a id="__codelineno-12-59" name="__codelineno-12-59" href="#__codelineno-12-59"></a><span class="s2">                        stop: 0.5</span>
</span><span id="__span-12-60"><a id="__codelineno-12-60" name="__codelineno-12-60" href="#__codelineno-12-60"></a><span class="s2">                        step: 0.1</span>
</span><span id="__span-12-61"><a id="__codelineno-12-61" name="__codelineno-12-61" href="#__codelineno-12-61"></a><span class="s2">                -</span>
</span><span id="__span-12-62"><a id="__codelineno-12-62" name="__codelineno-12-62" href="#__codelineno-12-62"></a><span class="s2">                    in_dim: !reference</span>
</span><span id="__span-12-63"><a id="__codelineno-12-63" name="__codelineno-12-63" href="#__codelineno-12-63"></a><span class="s2">                        target: model.nn[0].out_dim</span>
</span><span id="__span-12-64"><a id="__codelineno-12-64" name="__codelineno-12-64" href="#__codelineno-12-64"></a><span class="s2">                    out_dim: !sweep</span>
</span><span id="__span-12-65"><a id="__codelineno-12-65" name="__codelineno-12-65" href="#__codelineno-12-65"></a><span class="s2">                        values: [16, 32]</span>
</span><span id="__span-12-66"><a id="__codelineno-12-66" name="__codelineno-12-66" href="#__codelineno-12-66"></a><span class="s2">                    dropout: !range</span>
</span><span id="__span-12-67"><a id="__codelineno-12-67" name="__codelineno-12-67" href="#__codelineno-12-67"></a><span class="s2">                        start: 0.2</span>
</span><span id="__span-12-68"><a id="__codelineno-12-68" name="__codelineno-12-68" href="#__codelineno-12-68"></a><span class="s2">                        stop: 0.5</span>
</span><span id="__span-12-69"><a id="__codelineno-12-69" name="__codelineno-12-69" href="#__codelineno-12-69"></a><span class="s2">                        step: 0.1</span>
</span><span id="__span-12-70"><a id="__codelineno-12-70" name="__codelineno-12-70" href="#__codelineno-12-70"></a><span class="s2">                -</span>
</span><span id="__span-12-71"><a id="__codelineno-12-71" name="__codelineno-12-71" href="#__codelineno-12-71"></a><span class="s2">                    in_dim: !reference</span>
</span><span id="__span-12-72"><a id="__codelineno-12-72" name="__codelineno-12-72" href="#__codelineno-12-72"></a><span class="s2">                        target: model.nn[1].out_dim</span>
</span><span id="__span-12-73"><a id="__codelineno-12-73" name="__codelineno-12-73" href="#__codelineno-12-73"></a><span class="s2">                    out_dim: !sweep</span>
</span><span id="__span-12-74"><a id="__codelineno-12-74" name="__codelineno-12-74" href="#__codelineno-12-74"></a><span class="s2">                        values: [16, 32]</span>
</span><span id="__span-12-75"><a id="__codelineno-12-75" name="__codelineno-12-75" href="#__codelineno-12-75"></a><span class="s2">                    dropout: !range</span>
</span><span id="__span-12-76"><a id="__codelineno-12-76" name="__codelineno-12-76" href="#__codelineno-12-76"></a><span class="s2">                        start: 0.2</span>
</span><span id="__span-12-77"><a id="__codelineno-12-77" name="__codelineno-12-77" href="#__codelineno-12-77"></a><span class="s2">                        stop: 0.5</span>
</span><span id="__span-12-78"><a id="__codelineno-12-78" name="__codelineno-12-78" href="#__codelineno-12-78"></a><span class="s2">                        step: 0.1</span>
</span><span id="__span-12-79"><a id="__codelineno-12-79" name="__codelineno-12-79" href="#__codelineno-12-79"></a><span class="s2">        training:</span>
</span><span id="__span-12-80"><a id="__codelineno-12-80" name="__codelineno-12-80" href="#__codelineno-12-80"></a><span class="s2">            batch_size: !sweep</span>
</span><span id="__span-12-81"><a id="__codelineno-12-81" name="__codelineno-12-81" href="#__codelineno-12-81"></a><span class="s2">                values: [16, 32]</span>
</span><span id="__span-12-82"><a id="__codelineno-12-82" name="__codelineno-12-82" href="#__codelineno-12-82"></a><span class="s2">            optimizer: !sweep</span>
</span><span id="__span-12-83"><a id="__codelineno-12-83" name="__codelineno-12-83" href="#__codelineno-12-83"></a><span class="s2">                values: [&quot;Adam&quot;, &quot;SGD&quot;]</span>
</span><span id="__span-12-84"><a id="__codelineno-12-84" name="__codelineno-12-84" href="#__codelineno-12-84"></a><span class="s2">            lr: !random_uniform</span>
</span><span id="__span-12-85"><a id="__codelineno-12-85" name="__codelineno-12-85" href="#__codelineno-12-85"></a><span class="s2">                start: 1e-5</span>
</span><span id="__span-12-86"><a id="__codelineno-12-86" name="__codelineno-12-86" href="#__codelineno-12-86"></a><span class="s2">                stop: 1e-2</span>
</span><span id="__span-12-87"><a id="__codelineno-12-87" name="__codelineno-12-87" href="#__codelineno-12-87"></a><span class="s2">                log: true</span>
</span><span id="__span-12-88"><a id="__codelineno-12-88" name="__codelineno-12-88" href="#__codelineno-12-88"></a><span class="s2">            epochs: !sweep</span>
</span><span id="__span-12-89"><a id="__codelineno-12-89" name="__codelineno-12-89" href="#__codelineno-12-89"></a><span class="s2">                values: [2, 5, 7]</span>
</span><span id="__span-12-90"><a id="__codelineno-12-90" name="__codelineno-12-90" href="#__codelineno-12-90"></a><span class="s2">    &quot;&quot;&quot;</span>
</span><span id="__span-12-91"><a id="__codelineno-12-91" name="__codelineno-12-91" href="#__codelineno-12-91"></a>
</span><span id="__span-12-92"><a id="__codelineno-12-92" name="__codelineno-12-92" href="#__codelineno-12-92"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-12-93"><a id="__codelineno-12-93" name="__codelineno-12-93" href="#__codelineno-12-93"></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">yaml_text</span><span class="p">)</span>
</span><span id="__span-12-94"><a id="__codelineno-12-94" name="__codelineno-12-94" href="#__codelineno-12-94"></a>
</span><span id="__span-12-95"><a id="__codelineno-12-95" name="__codelineno-12-95" href="#__codelineno-12-95"></a>
</span><span id="__span-12-96"><a id="__codelineno-12-96" name="__codelineno-12-96" href="#__codelineno-12-96"></a><span class="k">def</span><span class="w"> </span><span class="nf">define_small_model</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
</span><span id="__span-12-97"><a id="__codelineno-12-97" name="__codelineno-12-97" href="#__codelineno-12-97"></a>    <span class="n">n_layers</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">][</span><span class="s2">&quot;n_layers&quot;</span><span class="p">]</span>
</span><span id="__span-12-98"><a id="__codelineno-12-98" name="__codelineno-12-98" href="#__codelineno-12-98"></a>    <span class="n">layers</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-12-99"><a id="__codelineno-12-99" name="__codelineno-12-99" href="#__codelineno-12-99"></a>
</span><span id="__span-12-100"><a id="__codelineno-12-100" name="__codelineno-12-100" href="#__codelineno-12-100"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_layers</span><span class="p">):</span>
</span><span id="__span-12-101"><a id="__codelineno-12-101" name="__codelineno-12-101" href="#__codelineno-12-101"></a>        <span class="n">in_dim</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">][</span><span class="s2">&quot;nn&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;in_dim&quot;</span><span class="p">]</span>
</span><span id="__span-12-102"><a id="__codelineno-12-102" name="__codelineno-12-102" href="#__codelineno-12-102"></a>        <span class="n">out_dim</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">][</span><span class="s2">&quot;nn&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;out_dim&quot;</span><span class="p">]</span>
</span><span id="__span-12-103"><a id="__codelineno-12-103" name="__codelineno-12-103" href="#__codelineno-12-103"></a>        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_dim</span><span class="p">,</span> <span class="n">out_dim</span><span class="p">))</span>
</span><span id="__span-12-104"><a id="__codelineno-12-104" name="__codelineno-12-104" href="#__codelineno-12-104"></a>        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">())</span>
</span><span id="__span-12-105"><a id="__codelineno-12-105" name="__codelineno-12-105" href="#__codelineno-12-105"></a>        <span class="n">dropout</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">][</span><span class="s2">&quot;nn&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;dropout&quot;</span><span class="p">]</span>
</span><span id="__span-12-106"><a id="__codelineno-12-106" name="__codelineno-12-106" href="#__codelineno-12-106"></a>        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout</span><span class="p">))</span>
</span><span id="__span-12-107"><a id="__codelineno-12-107" name="__codelineno-12-107" href="#__codelineno-12-107"></a>
</span><span id="__span-12-108"><a id="__codelineno-12-108" name="__codelineno-12-108" href="#__codelineno-12-108"></a>    <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">out_dim</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>  <span class="c1"># classification of 10 classes</span>
</span><span id="__span-12-109"><a id="__codelineno-12-109" name="__codelineno-12-109" href="#__codelineno-12-109"></a>    <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">LogSoftmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span><span id="__span-12-110"><a id="__codelineno-12-110" name="__codelineno-12-110" href="#__codelineno-12-110"></a>
</span><span id="__span-12-111"><a id="__codelineno-12-111" name="__codelineno-12-111" href="#__codelineno-12-111"></a>    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">layers</span><span class="p">)</span>
</span><span id="__span-12-112"><a id="__codelineno-12-112" name="__codelineno-12-112" href="#__codelineno-12-112"></a>
</span><span id="__span-12-113"><a id="__codelineno-12-113" name="__codelineno-12-113" href="#__codelineno-12-113"></a>
</span><span id="__span-12-114"><a id="__codelineno-12-114" name="__codelineno-12-114" href="#__codelineno-12-114"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">dir_path</span><span class="p">):</span>
</span><span id="__span-12-115"><a id="__codelineno-12-115" name="__codelineno-12-115" href="#__codelineno-12-115"></a>    <span class="n">batch_size</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">][</span><span class="s2">&quot;batch_size&quot;</span><span class="p">]</span>
</span><span id="__span-12-116"><a id="__codelineno-12-116" name="__codelineno-12-116" href="#__codelineno-12-116"></a>    <span class="c1"># Load FashionMNIST dataset.</span>
</span><span id="__span-12-117"><a id="__codelineno-12-117" name="__codelineno-12-117" href="#__codelineno-12-117"></a>    <span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
</span><span id="__span-12-118"><a id="__codelineno-12-118" name="__codelineno-12-118" href="#__codelineno-12-118"></a>        <span class="n">datasets</span><span class="o">.</span><span class="n">FashionMNIST</span><span class="p">(</span>
</span><span id="__span-12-119"><a id="__codelineno-12-119" name="__codelineno-12-119" href="#__codelineno-12-119"></a>            <span class="n">dir_path</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">()</span>
</span><span id="__span-12-120"><a id="__codelineno-12-120" name="__codelineno-12-120" href="#__codelineno-12-120"></a>        <span class="p">),</span>
</span><span id="__span-12-121"><a id="__codelineno-12-121" name="__codelineno-12-121" href="#__codelineno-12-121"></a>        <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
</span><span id="__span-12-122"><a id="__codelineno-12-122" name="__codelineno-12-122" href="#__codelineno-12-122"></a>        <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-12-123"><a id="__codelineno-12-123" name="__codelineno-12-123" href="#__codelineno-12-123"></a>    <span class="p">)</span>
</span><span id="__span-12-124"><a id="__codelineno-12-124" name="__codelineno-12-124" href="#__codelineno-12-124"></a>    <span class="n">valid_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
</span><span id="__span-12-125"><a id="__codelineno-12-125" name="__codelineno-12-125" href="#__codelineno-12-125"></a>        <span class="n">datasets</span><span class="o">.</span><span class="n">FashionMNIST</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">()),</span>
</span><span id="__span-12-126"><a id="__codelineno-12-126" name="__codelineno-12-126" href="#__codelineno-12-126"></a>        <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
</span><span id="__span-12-127"><a id="__codelineno-12-127" name="__codelineno-12-127" href="#__codelineno-12-127"></a>        <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-12-128"><a id="__codelineno-12-128" name="__codelineno-12-128" href="#__codelineno-12-128"></a>    <span class="p">)</span>
</span><span id="__span-12-129"><a id="__codelineno-12-129" name="__codelineno-12-129" href="#__codelineno-12-129"></a>
</span><span id="__span-12-130"><a id="__codelineno-12-130" name="__codelineno-12-130" href="#__codelineno-12-130"></a>    <span class="k">return</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">valid_loader</span>
</span><span id="__span-12-131"><a id="__codelineno-12-131" name="__codelineno-12-131" href="#__codelineno-12-131"></a>
</span><span id="__span-12-132"><a id="__codelineno-12-132" name="__codelineno-12-132" href="#__codelineno-12-132"></a>
</span><span id="__span-12-133"><a id="__codelineno-12-133" name="__codelineno-12-133" href="#__codelineno-12-133"></a><span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">trial</span><span class="o">.</span><span class="n">Trial</span><span class="p">,</span> <span class="n">config_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
</span><span id="__span-12-134"><a id="__codelineno-12-134" name="__codelineno-12-134" href="#__codelineno-12-134"></a>
</span><span id="__span-12-135"><a id="__codelineno-12-135" name="__codelineno-12-135" href="#__codelineno-12-135"></a>    <span class="n">search_space</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">build_search_space</span><span class="p">(</span>
</span><span id="__span-12-136"><a id="__codelineno-12-136" name="__codelineno-12-136" href="#__codelineno-12-136"></a>        <span class="n">config_file</span><span class="o">=</span><span class="n">config_file</span><span class="p">,</span>
</span><span id="__span-12-137"><a id="__codelineno-12-137" name="__codelineno-12-137" href="#__codelineno-12-137"></a>        <span class="n">trial</span><span class="o">=</span><span class="n">trial</span><span class="p">,</span>
</span><span id="__span-12-138"><a id="__codelineno-12-138" name="__codelineno-12-138" href="#__codelineno-12-138"></a>    <span class="p">)</span>
</span><span id="__span-12-139"><a id="__codelineno-12-139" name="__codelineno-12-139" href="#__codelineno-12-139"></a>
</span><span id="__span-12-140"><a id="__codelineno-12-140" name="__codelineno-12-140" href="#__codelineno-12-140"></a>    <span class="c1"># prepare model</span>
</span><span id="__span-12-141"><a id="__codelineno-12-141" name="__codelineno-12-141" href="#__codelineno-12-141"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">define_small_model</span><span class="p">(</span><span class="n">search_space</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
</span><span id="__span-12-142"><a id="__codelineno-12-142" name="__codelineno-12-142" href="#__codelineno-12-142"></a>
</span><span id="__span-12-143"><a id="__codelineno-12-143" name="__codelineno-12-143" href="#__codelineno-12-143"></a>    <span class="c1"># prepare optimizer</span>
</span><span id="__span-12-144"><a id="__codelineno-12-144" name="__codelineno-12-144" href="#__codelineno-12-144"></a>    <span class="n">optimizer_name</span> <span class="o">=</span> <span class="n">search_space</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">][</span><span class="s2">&quot;optimizer&quot;</span><span class="p">]</span>
</span><span id="__span-12-145"><a id="__codelineno-12-145" name="__codelineno-12-145" href="#__codelineno-12-145"></a>    <span class="n">lr</span> <span class="o">=</span> <span class="n">search_space</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">][</span><span class="s2">&quot;lr&quot;</span><span class="p">]</span>
</span><span id="__span-12-146"><a id="__codelineno-12-146" name="__codelineno-12-146" href="#__codelineno-12-146"></a>    <span class="n">optimizer</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="p">,</span> <span class="n">optimizer_name</span><span class="p">)(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>
</span><span id="__span-12-147"><a id="__codelineno-12-147" name="__codelineno-12-147" href="#__codelineno-12-147"></a>
</span><span id="__span-12-148"><a id="__codelineno-12-148" name="__codelineno-12-148" href="#__codelineno-12-148"></a>    <span class="c1"># prepare data</span>
</span><span id="__span-12-149"><a id="__codelineno-12-149" name="__codelineno-12-149" href="#__codelineno-12-149"></a>    <span class="n">data_dir</span> <span class="o">=</span> <span class="n">tmp_dir</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span>
</span><span id="__span-12-150"><a id="__codelineno-12-150" name="__codelineno-12-150" href="#__codelineno-12-150"></a>    <span class="n">train_loader</span><span class="p">,</span> <span class="n">valid_loader</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">search_space</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</span><span id="__span-12-151"><a id="__codelineno-12-151" name="__codelineno-12-151" href="#__codelineno-12-151"></a>
</span><span id="__span-12-152"><a id="__codelineno-12-152" name="__codelineno-12-152" href="#__codelineno-12-152"></a>    <span class="c1"># train the model</span>
</span><span id="__span-12-153"><a id="__codelineno-12-153" name="__codelineno-12-153" href="#__codelineno-12-153"></a>    <span class="n">epochs</span> <span class="o">=</span> <span class="n">search_space</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">][</span><span class="s2">&quot;epochs&quot;</span><span class="p">]</span>
</span><span id="__span-12-154"><a id="__codelineno-12-154" name="__codelineno-12-154" href="#__codelineno-12-154"></a>    <span class="n">batch_size</span> <span class="o">=</span> <span class="n">search_space</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">][</span><span class="s2">&quot;batch_size&quot;</span><span class="p">]</span>
</span><span id="__span-12-155"><a id="__codelineno-12-155" name="__codelineno-12-155" href="#__codelineno-12-155"></a>    <span class="n">n_train_examples</span> <span class="o">=</span> <span class="n">batch_size</span> <span class="o">*</span> <span class="mi">30</span>
</span><span id="__span-12-156"><a id="__codelineno-12-156" name="__codelineno-12-156" href="#__codelineno-12-156"></a>    <span class="n">n_valid_examples</span> <span class="o">=</span> <span class="n">batch_size</span> <span class="o">*</span> <span class="mi">10</span>
</span><span id="__span-12-157"><a id="__codelineno-12-157" name="__codelineno-12-157" href="#__codelineno-12-157"></a>
</span><span id="__span-12-158"><a id="__codelineno-12-158" name="__codelineno-12-158" href="#__codelineno-12-158"></a>    <span class="c1"># training loop</span>
</span><span id="__span-12-159"><a id="__codelineno-12-159" name="__codelineno-12-159" href="#__codelineno-12-159"></a>    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
</span><span id="__span-12-160"><a id="__codelineno-12-160" name="__codelineno-12-160" href="#__codelineno-12-160"></a>        <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</span><span id="__span-12-161"><a id="__codelineno-12-161" name="__codelineno-12-161" href="#__codelineno-12-161"></a>        <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
</span><span id="__span-12-162"><a id="__codelineno-12-162" name="__codelineno-12-162" href="#__codelineno-12-162"></a>            <span class="k">if</span> <span class="n">batch_idx</span> <span class="o">*</span> <span class="n">batch_size</span> <span class="o">&gt;</span> <span class="n">n_train_examples</span><span class="p">:</span>
</span><span id="__span-12-163"><a id="__codelineno-12-163" name="__codelineno-12-163" href="#__codelineno-12-163"></a>                <span class="k">break</span>
</span><span id="__span-12-164"><a id="__codelineno-12-164" name="__codelineno-12-164" href="#__codelineno-12-164"></a>
</span><span id="__span-12-165"><a id="__codelineno-12-165" name="__codelineno-12-165" href="#__codelineno-12-165"></a>            <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">),</span> <span class="n">target</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
</span><span id="__span-12-166"><a id="__codelineno-12-166" name="__codelineno-12-166" href="#__codelineno-12-166"></a>
</span><span id="__span-12-167"><a id="__codelineno-12-167" name="__codelineno-12-167" href="#__codelineno-12-167"></a>            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
</span><span id="__span-12-168"><a id="__codelineno-12-168" name="__codelineno-12-168" href="#__codelineno-12-168"></a>            <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="__span-12-169"><a id="__codelineno-12-169" name="__codelineno-12-169" href="#__codelineno-12-169"></a>            <span class="n">loss</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">NLLLoss</span><span class="p">()(</span><span class="n">output</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
</span><span id="__span-12-170"><a id="__codelineno-12-170" name="__codelineno-12-170" href="#__codelineno-12-170"></a>            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</span><span id="__span-12-171"><a id="__codelineno-12-171" name="__codelineno-12-171" href="#__codelineno-12-171"></a>            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</span><span id="__span-12-172"><a id="__codelineno-12-172" name="__codelineno-12-172" href="#__codelineno-12-172"></a>
</span><span id="__span-12-173"><a id="__codelineno-12-173" name="__codelineno-12-173" href="#__codelineno-12-173"></a>        <span class="c1"># validate the model</span>
</span><span id="__span-12-174"><a id="__codelineno-12-174" name="__codelineno-12-174" href="#__codelineno-12-174"></a>        <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</span><span id="__span-12-175"><a id="__codelineno-12-175" name="__codelineno-12-175" href="#__codelineno-12-175"></a>        <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-12-176"><a id="__codelineno-12-176" name="__codelineno-12-176" href="#__codelineno-12-176"></a>        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
</span><span id="__span-12-177"><a id="__codelineno-12-177" name="__codelineno-12-177" href="#__codelineno-12-177"></a>            <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">valid_loader</span><span class="p">):</span>
</span><span id="__span-12-178"><a id="__codelineno-12-178" name="__codelineno-12-178" href="#__codelineno-12-178"></a>                <span class="k">if</span> <span class="n">batch_idx</span> <span class="o">*</span> <span class="n">batch_size</span> <span class="o">&gt;</span> <span class="n">n_valid_examples</span><span class="p">:</span>
</span><span id="__span-12-179"><a id="__codelineno-12-179" name="__codelineno-12-179" href="#__codelineno-12-179"></a>                    <span class="k">break</span>
</span><span id="__span-12-180"><a id="__codelineno-12-180" name="__codelineno-12-180" href="#__codelineno-12-180"></a>
</span><span id="__span-12-181"><a id="__codelineno-12-181" name="__codelineno-12-181" href="#__codelineno-12-181"></a>                <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">),</span> <span class="n">target</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
</span><span id="__span-12-182"><a id="__codelineno-12-182" name="__codelineno-12-182" href="#__codelineno-12-182"></a>                <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="__span-12-183"><a id="__codelineno-12-183" name="__codelineno-12-183" href="#__codelineno-12-183"></a>                <span class="n">pred</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-12-184"><a id="__codelineno-12-184" name="__codelineno-12-184" href="#__codelineno-12-184"></a>                <span class="n">correct</span> <span class="o">+=</span> <span class="n">pred</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">view_as</span><span class="p">(</span><span class="n">pred</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="__span-12-185"><a id="__codelineno-12-185" name="__codelineno-12-185" href="#__codelineno-12-185"></a>
</span><span id="__span-12-186"><a id="__codelineno-12-186" name="__codelineno-12-186" href="#__codelineno-12-186"></a>        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">correct</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">),</span> <span class="n">n_valid_examples</span><span class="p">)</span>
</span><span id="__span-12-187"><a id="__codelineno-12-187" name="__codelineno-12-187" href="#__codelineno-12-187"></a>
</span><span id="__span-12-188"><a id="__codelineno-12-188" name="__codelineno-12-188" href="#__codelineno-12-188"></a>        <span class="c1"># report value to Optuna</span>
</span><span id="__span-12-189"><a id="__codelineno-12-189" name="__codelineno-12-189" href="#__codelineno-12-189"></a>        <span class="n">trial</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">epoch</span><span class="p">)</span>
</span><span id="__span-12-190"><a id="__codelineno-12-190" name="__codelineno-12-190" href="#__codelineno-12-190"></a>
</span><span id="__span-12-191"><a id="__codelineno-12-191" name="__codelineno-12-191" href="#__codelineno-12-191"></a>        <span class="c1"># prune trial if needed</span>
</span><span id="__span-12-192"><a id="__codelineno-12-192" name="__codelineno-12-192" href="#__codelineno-12-192"></a>        <span class="k">if</span> <span class="n">trial</span><span class="o">.</span><span class="n">should_prune</span><span class="p">():</span>
</span><span id="__span-12-193"><a id="__codelineno-12-193" name="__codelineno-12-193" href="#__codelineno-12-193"></a>            <span class="k">raise</span> <span class="n">optuna</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">TrialPruned</span><span class="p">()</span>
</span><span id="__span-12-194"><a id="__codelineno-12-194" name="__codelineno-12-194" href="#__codelineno-12-194"></a>    <span class="k">return</span> <span class="n">accuracy</span>
</span><span id="__span-12-195"><a id="__codelineno-12-195" name="__codelineno-12-195" href="#__codelineno-12-195"></a>
</span><span id="__span-12-196"><a id="__codelineno-12-196" name="__codelineno-12-196" href="#__codelineno-12-196"></a>
</span><span id="__span-12-197"><a id="__codelineno-12-197" name="__codelineno-12-197" href="#__codelineno-12-197"></a><span class="k">def</span><span class="w"> </span><span class="nf">tune_integration</span><span class="p">(</span><span class="n">run_idx</span><span class="p">,</span> <span class="n">tuning_config</span><span class="p">):</span>  <span class="c1"># run_idx is the iteration index</span>
</span><span id="__span-12-198"><a id="__codelineno-12-198" name="__codelineno-12-198" href="#__codelineno-12-198"></a>
</span><span id="__span-12-199"><a id="__codelineno-12-199" name="__codelineno-12-199" href="#__codelineno-12-199"></a>    <span class="n">study</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">tuning_config</span><span class="p">)</span>
</span><span id="__span-12-200"><a id="__codelineno-12-200" name="__codelineno-12-200" href="#__codelineno-12-200"></a>    <span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span>
</span><span id="__span-12-201"><a id="__codelineno-12-201" name="__codelineno-12-201" href="#__codelineno-12-201"></a>        <span class="n">partial</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">config_file</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">tuning_config</span><span class="p">[</span><span class="s2">&quot;config_file&quot;</span><span class="p">])),</span>
</span><span id="__span-12-202"><a id="__codelineno-12-202" name="__codelineno-12-202" href="#__codelineno-12-202"></a>        <span class="n">n_trials</span><span class="o">=</span><span class="n">tuning_config</span><span class="p">[</span><span class="s2">&quot;n_trials&quot;</span><span class="p">],</span>
</span><span id="__span-12-203"><a id="__codelineno-12-203" name="__codelineno-12-203" href="#__codelineno-12-203"></a>        <span class="n">timeout</span><span class="o">=</span><span class="n">tuning_config</span><span class="p">[</span><span class="s2">&quot;timeout&quot;</span><span class="p">],</span>
</span><span id="__span-12-204"><a id="__codelineno-12-204" name="__codelineno-12-204" href="#__codelineno-12-204"></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="n">tuning_config</span><span class="p">[</span><span class="s2">&quot;n_jobs&quot;</span><span class="p">],</span>
</span><span id="__span-12-205"><a id="__codelineno-12-205" name="__codelineno-12-205" href="#__codelineno-12-205"></a>    <span class="p">)</span>
</span><span id="__span-12-206"><a id="__codelineno-12-206" name="__codelineno-12-206" href="#__codelineno-12-206"></a>
</span><span id="__span-12-207"><a id="__codelineno-12-207" name="__codelineno-12-207" href="#__codelineno-12-207"></a>    <span class="n">pruned_trials</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">get_trials</span><span class="p">(</span>
</span><span id="__span-12-208"><a id="__codelineno-12-208" name="__codelineno-12-208" href="#__codelineno-12-208"></a>        <span class="n">deepcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="n">optuna</span><span class="o">.</span><span class="n">trial</span><span class="o">.</span><span class="n">TrialState</span><span class="o">.</span><span class="n">PRUNED</span><span class="p">]</span>
</span><span id="__span-12-209"><a id="__codelineno-12-209" name="__codelineno-12-209" href="#__codelineno-12-209"></a>    <span class="p">)</span>
</span><span id="__span-12-210"><a id="__codelineno-12-210" name="__codelineno-12-210" href="#__codelineno-12-210"></a>    <span class="n">complete_trials</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">get_trials</span><span class="p">(</span>
</span><span id="__span-12-211"><a id="__codelineno-12-211" name="__codelineno-12-211" href="#__codelineno-12-211"></a>        <span class="n">deepcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="p">[</span><span class="n">optuna</span><span class="o">.</span><span class="n">trial</span><span class="o">.</span><span class="n">TrialState</span><span class="o">.</span><span class="n">COMPLETE</span><span class="p">]</span>
</span><span id="__span-12-212"><a id="__codelineno-12-212" name="__codelineno-12-212" href="#__codelineno-12-212"></a>    <span class="p">)</span>
</span><span id="__span-12-213"><a id="__codelineno-12-213" name="__codelineno-12-213" href="#__codelineno-12-213"></a>
</span><span id="__span-12-214"><a id="__codelineno-12-214" name="__codelineno-12-214" href="#__codelineno-12-214"></a>    <span class="k">return</span> <span class="p">(</span>
</span><span id="__span-12-215"><a id="__codelineno-12-215" name="__codelineno-12-215" href="#__codelineno-12-215"></a>        <span class="nb">len</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">trials</span><span class="p">),</span>
</span><span id="__span-12-216"><a id="__codelineno-12-216" name="__codelineno-12-216" href="#__codelineno-12-216"></a>        <span class="nb">len</span><span class="p">(</span><span class="n">pruned_trials</span><span class="p">),</span>
</span><span id="__span-12-217"><a id="__codelineno-12-217" name="__codelineno-12-217" href="#__codelineno-12-217"></a>        <span class="nb">len</span><span class="p">(</span><span class="n">complete_trials</span><span class="p">),</span>
</span><span id="__span-12-218"><a id="__codelineno-12-218" name="__codelineno-12-218" href="#__codelineno-12-218"></a>        <span class="n">study</span><span class="o">.</span><span class="n">best_trial</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="__span-12-219"><a id="__codelineno-12-219" name="__codelineno-12-219" href="#__codelineno-12-219"></a>    <span class="p">)</span>
</span><span id="__span-12-220"><a id="__codelineno-12-220" name="__codelineno-12-220" href="#__codelineno-12-220"></a>
</span><span id="__span-12-221"><a id="__codelineno-12-221" name="__codelineno-12-221" href="#__codelineno-12-221"></a>
</span><span id="__span-12-222"><a id="__codelineno-12-222" name="__codelineno-12-222" href="#__codelineno-12-222"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-12-223"><a id="__codelineno-12-223" name="__codelineno-12-223" href="#__codelineno-12-223"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">tmp_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="__span-12-224"><a id="__codelineno-12-224" name="__codelineno-12-224" href="#__codelineno-12-224"></a>        <span class="n">tmp_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-12-225"><a id="__codelineno-12-225" name="__codelineno-12-225" href="#__codelineno-12-225"></a>
</span><span id="__span-12-226"><a id="__codelineno-12-226" name="__codelineno-12-226" href="#__codelineno-12-226"></a>    <span class="c1"># create tuning config</span>
</span><span id="__span-12-227"><a id="__codelineno-12-227" name="__codelineno-12-227" href="#__codelineno-12-227"></a>    <span class="n">tuning_config</span> <span class="o">=</span> <span class="n">tune</span><span class="o">.</span><span class="n">load_yaml</span><span class="p">(</span><span class="n">create_tuning_config_file</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">))</span>
</span><span id="__span-12-228"><a id="__codelineno-12-228" name="__codelineno-12-228" href="#__codelineno-12-228"></a>    <span class="n">n_processes</span> <span class="o">=</span> <span class="n">tuning_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;n_processes&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-12-229"><a id="__codelineno-12-229" name="__codelineno-12-229" href="#__codelineno-12-229"></a>    <span class="n">n_iterations</span> <span class="o">=</span> <span class="n">tuning_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;n_iterations&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-12-230"><a id="__codelineno-12-230" name="__codelineno-12-230" href="#__codelineno-12-230"></a>
</span><span id="__span-12-231"><a id="__codelineno-12-231" name="__codelineno-12-231" href="#__codelineno-12-231"></a>    <span class="c1"># create config file</span>
</span><span id="__span-12-232"><a id="__codelineno-12-232" name="__codelineno-12-232" href="#__codelineno-12-232"></a>    <span class="n">create_config_file</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">tuning_config</span><span class="p">[</span><span class="s2">&quot;config_file&quot;</span><span class="p">]))</span>
</span><span id="__span-12-233"><a id="__codelineno-12-233" name="__codelineno-12-233" href="#__codelineno-12-233"></a>
</span><span id="__span-12-234"><a id="__codelineno-12-234" name="__codelineno-12-234" href="#__codelineno-12-234"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting the tuning integration process...&quot;</span><span class="p">)</span>
</span><span id="__span-12-235"><a id="__codelineno-12-235" name="__codelineno-12-235" href="#__codelineno-12-235"></a>    <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="n">n_processes</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
</span><span id="__span-12-236"><a id="__codelineno-12-236" name="__codelineno-12-236" href="#__codelineno-12-236"></a>        <span class="n">local_results</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
</span><span id="__span-12-237"><a id="__codelineno-12-237" name="__codelineno-12-237" href="#__codelineno-12-237"></a>            <span class="n">partial</span><span class="p">(</span><span class="n">tune_integration</span><span class="p">,</span> <span class="n">tuning_config</span><span class="o">=</span><span class="n">tuning_config</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iterations</span><span class="p">)</span>
</span><span id="__span-12-238"><a id="__codelineno-12-238" name="__codelineno-12-238" href="#__codelineno-12-238"></a>        <span class="p">)</span>
</span><span id="__span-12-239"><a id="__codelineno-12-239" name="__codelineno-12-239" href="#__codelineno-12-239"></a>
</span><span id="__span-12-240"><a id="__codelineno-12-240" name="__codelineno-12-240" href="#__codelineno-12-240"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tuning results for each run:------------------&quot;</span><span class="p">)</span>
</span><span id="__span-12-241"><a id="__codelineno-12-241" name="__codelineno-12-241" href="#__codelineno-12-241"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">local_results</span><span class="p">):</span>
</span><span id="__span-12-242"><a id="__codelineno-12-242" name="__codelineno-12-242" href="#__codelineno-12-242"></a>        <span class="n">n_trials</span><span class="p">,</span> <span class="n">n_pruned</span><span class="p">,</span> <span class="n">n_complete</span><span class="p">,</span> <span class="n">best_value</span> <span class="o">=</span> <span class="n">result</span>
</span><span id="__span-12-243"><a id="__codelineno-12-243" name="__codelineno-12-243" href="#__codelineno-12-243"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Study statistics for run </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: &quot;</span><span class="p">)</span>
</span><span id="__span-12-244"><a id="__codelineno-12-244" name="__codelineno-12-244" href="#__codelineno-12-244"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Number of finished trials: &quot;</span><span class="p">,</span> <span class="n">n_trials</span><span class="p">)</span>
</span><span id="__span-12-245"><a id="__codelineno-12-245" name="__codelineno-12-245" href="#__codelineno-12-245"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Number of pruned trials: &quot;</span><span class="p">,</span> <span class="n">n_pruned</span><span class="p">)</span>
</span><span id="__span-12-246"><a id="__codelineno-12-246" name="__codelineno-12-246" href="#__codelineno-12-246"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Number of complete trials: &quot;</span><span class="p">,</span> <span class="n">n_complete</span><span class="p">)</span>
</span><span id="__span-12-247"><a id="__codelineno-12-247" name="__codelineno-12-247" href="#__codelineno-12-247"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Best trial value: &quot;</span><span class="p">,</span> <span class="n">best_value</span><span class="p">)</span>
</span><span id="__span-12-248"><a id="__codelineno-12-248" name="__codelineno-12-248" href="#__codelineno-12-248"></a>
</span><span id="__span-12-249"><a id="__codelineno-12-249" name="__codelineno-12-249" href="#__codelineno-12-249"></a>    <span class="n">storage</span> <span class="o">=</span> <span class="n">JournalStorage</span><span class="p">(</span>
</span><span id="__span-12-250"><a id="__codelineno-12-250" name="__codelineno-12-250" href="#__codelineno-12-250"></a>        <span class="n">JournalFileBackend</span><span class="p">(</span><span class="n">tuning_config</span><span class="p">[</span><span class="s2">&quot;storage&quot;</span><span class="p">])</span>  <span class="c1"># use uncompressed journal</span>
</span><span id="__span-12-251"><a id="__codelineno-12-251" name="__codelineno-12-251" href="#__codelineno-12-251"></a>    <span class="p">)</span>
</span><span id="__span-12-252"><a id="__codelineno-12-252" name="__codelineno-12-252" href="#__codelineno-12-252"></a>    <span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">load_study</span><span class="p">(</span><span class="n">study_name</span><span class="o">=</span><span class="n">tuning_config</span><span class="p">[</span><span class="s2">&quot;study_name&quot;</span><span class="p">],</span> <span class="n">storage</span><span class="o">=</span><span class="n">storage</span><span class="p">)</span>
</span><span id="__span-12-253"><a id="__codelineno-12-253" name="__codelineno-12-253" href="#__codelineno-12-253"></a>
</span><span id="__span-12-254"><a id="__codelineno-12-254" name="__codelineno-12-254" href="#__codelineno-12-254"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best trial global:----------------------------&quot;</span><span class="p">)</span>
</span><span id="__span-12-255"><a id="__codelineno-12-255" name="__codelineno-12-255" href="#__codelineno-12-255"></a>    <span class="n">trial</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">best_trial</span>
</span><span id="__span-12-256"><a id="__codelineno-12-256" name="__codelineno-12-256" href="#__codelineno-12-256"></a>
</span><span id="__span-12-257"><a id="__codelineno-12-257" name="__codelineno-12-257" href="#__codelineno-12-257"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Value: &quot;</span><span class="p">,</span> <span class="n">trial</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="__span-12-258"><a id="__codelineno-12-258" name="__codelineno-12-258" href="#__codelineno-12-258"></a>
</span><span id="__span-12-259"><a id="__codelineno-12-259" name="__codelineno-12-259" href="#__codelineno-12-259"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Params: &quot;</span><span class="p">)</span>
</span><span id="__span-12-260"><a id="__codelineno-12-260" name="__codelineno-12-260" href="#__codelineno-12-260"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">trial</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-12-261"><a id="__codelineno-12-261" name="__codelineno-12-261" href="#__codelineno-12-261"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</span><span id="__span-12-262"><a id="__codelineno-12-262" name="__codelineno-12-262" href="#__codelineno-12-262"></a>
</span><span id="__span-12-263"><a id="__codelineno-12-263" name="__codelineno-12-263" href="#__codelineno-12-263"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saving the best configuration...&quot;</span><span class="p">)</span>
</span><span id="__span-12-264"><a id="__codelineno-12-264" name="__codelineno-12-264" href="#__codelineno-12-264"></a>    <span class="n">tune</span><span class="o">.</span><span class="n">save_best_config</span><span class="p">(</span>
</span><span id="__span-12-265"><a id="__codelineno-12-265" name="__codelineno-12-265" href="#__codelineno-12-265"></a>        <span class="n">config_file</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">tuning_config</span><span class="p">[</span><span class="s2">&quot;config_file&quot;</span><span class="p">]),</span>
</span><span id="__span-12-266"><a id="__codelineno-12-266" name="__codelineno-12-266" href="#__codelineno-12-266"></a>        <span class="n">best_trial</span><span class="o">=</span><span class="n">trial</span><span class="p">,</span>
</span><span id="__span-12-267"><a id="__codelineno-12-267" name="__codelineno-12-267" href="#__codelineno-12-267"></a>        <span class="n">output_file</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">tuning_config</span><span class="p">[</span><span class="s2">&quot;best_config_file&quot;</span><span class="p">]),</span>
</span><span id="__span-12-268"><a id="__codelineno-12-268" name="__codelineno-12-268" href="#__codelineno-12-268"></a>    <span class="p">)</span>
</span></code></pre></div>
<h4 id="example-result">Example result</h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>Starting<span class="w"> </span>the<span class="w"> </span>tuning<span class="w"> </span>integration<span class="w"> </span>process...
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:36,912<span class="o">]</span><span class="w"> </span>A<span class="w"> </span>new<span class="w"> </span>study<span class="w"> </span>created<span class="w"> </span><span class="k">in</span><span class="w"> </span>Journal<span class="w"> </span>with<span class="w"> </span>name:<span class="w"> </span>test_study
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>Study<span class="w"> </span>test_study<span class="w"> </span>was<span class="w"> </span>created<span class="w"> </span>and<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>/QuantumGrav/QuantumGravPy/docs/tmp/test_study.log.
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:36,946<span class="o">]</span><span class="w"> </span>Using<span class="w"> </span>an<span class="w"> </span>existing<span class="w"> </span>study<span class="w"> </span>with<span class="w"> </span>name<span class="w"> </span><span class="s1">&#39;test_study&#39;</span><span class="w"> </span>instead<span class="w"> </span>of<span class="w"> </span>creating<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>one.
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>Study<span class="w"> </span>test_study<span class="w"> </span>was<span class="w"> </span>created<span class="w"> </span>and<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>/QuantumGrav/QuantumGravPy/docs/tmp/test_study.log.
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="m">100</span>%<span class="p">|</span>███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">26</span>.4M/26.4M<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">57</span>.6MB/s<span class="o">]</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="m">100</span>%<span class="p">|</span>███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">26</span>.4M/26.4M<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">54</span>.9MB/s<span class="o">]</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="m">100</span>%<span class="p">|</span>███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">29</span>.5k/29.5k<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">4</span>.39MB/s<span class="o">]</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="m">100</span>%<span class="p">|</span>███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">29</span>.5k/29.5k<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">4</span>.53MB/s<span class="o">]</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="m">100</span>%<span class="p">|</span>███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">4</span>.42M/4.42M<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">43</span>.7MB/s<span class="o">]</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="m">100</span>%<span class="p">|</span>███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">4</span>.42M/4.42M<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">42</span>.4MB/s<span class="o">]</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="m">100</span>%<span class="p">|</span>███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">5</span>.15k/5.15k<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">88</span>.9MB/s<span class="o">]</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="m">100</span>%<span class="p">|</span>███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">5</span>.15k/5.15k<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">40</span>.9MB/s<span class="o">]</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:38,433<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.0016765190716563534,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625.
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:38,632<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">2</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.075<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">256</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;SGD&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.0002146791042032724,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">2</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625.
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:38,666<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">0</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.08125<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;SGD&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.0003945248169221987,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">7</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625.
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:38,894<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">3</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.0875<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;SGD&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.00018633239421692437,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625.
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:38,898<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">4</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.090625<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;SGD&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.00379972665577471,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">2</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625.
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:39,314<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">6</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.13125<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;SGD&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.0008484799816474145,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">7</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625.
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:39,435<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">5</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.1375<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">256</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;SGD&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">8</span>.354945492960286e-05,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">7</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625.
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:39,641<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">8</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.09375<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;SGD&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">8</span>.08272287524503e-05,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">2</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625.
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:39,718<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">7</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.11875<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">256</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;SGD&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.0006188877342998116,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">7</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625.
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:39,822<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">9</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.103125<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;SGD&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.0008168448454213926,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">2</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625.
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:39,913<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">10</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.134375<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">256</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;SGD&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.00021660920841439104,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">2</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625.
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:40,157<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">11</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.18125<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">256</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.00883615551351022,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625.
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:40,269<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">12</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.15625<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">256</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">1</span>.5473312399729955e-05,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625.
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:40,531<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">13</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.29375<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">256</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.009542442262415065,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625.
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:40,610<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">14</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.40625<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">256</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.008577489282530437,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.625.
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:40,855<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">15</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.6375<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.002801697167722077,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">15</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.6375.
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:40,924<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">16</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.5375<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.0024869223253056747,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">15</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.6375.
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:41,217<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">17</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.0017531394038905789,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">15</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.6375.
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:41,311<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">18</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.55625<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.0020300569180315316,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">15</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.6375.
</span><span id="__span-13-33"><a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:41,545<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">19</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.54375<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.0015706471695032163,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">15</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.6375.
</span><span id="__span-13-34"><a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:41,628<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">20</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.5875<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.0035034963024678494,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">15</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.6375.
</span><span id="__span-13-35"><a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:41,852<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">21</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.60625<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.004692563836368309,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">15</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.6375.
</span><span id="__span-13-36"><a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:41,949<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">22</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.475<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.00413377148937998,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">15</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.6375.
</span><span id="__span-13-37"><a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:42,158<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">23</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.5375<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.004366383387329541,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">15</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.6375.
</span><span id="__span-13-38"><a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:42,268<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">24</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.55625<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.005176248318654213,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">15</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.6375.
</span><span id="__span-13-39"><a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:42,493<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">25</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.51875<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.0011242281028770243,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">15</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.6375.
</span><span id="__span-13-40"><a id="__codelineno-13-40" name="__codelineno-13-40" href="#__codelineno-13-40"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:42,577<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">26</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.50625<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.001187102582494059,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">15</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.6375.
</span><span id="__span-13-41"><a id="__codelineno-13-41" name="__codelineno-13-41" href="#__codelineno-13-41"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:43,038<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">27</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.44375<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.0013102961720892286,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">15</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.6375.
</span><span id="__span-13-42"><a id="__codelineno-13-42" name="__codelineno-13-42" href="#__codelineno-13-42"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:43,132<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">28</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.465625<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.4,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.30000000000000004,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.0005325671025809822,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">5</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">15</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.6375.
</span><span id="__span-13-43"><a id="__codelineno-13-43" name="__codelineno-13-43" href="#__codelineno-13-43"></a><span class="o">[</span>I<span class="w"> </span><span class="m">2025</span>-11-07<span class="w"> </span><span class="m">11</span>:24:43,504<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">29</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.7125<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;model.nn.0.out_dim&#39;</span>:<span class="w"> </span><span class="m">128</span>,<span class="w"> </span><span class="s1">&#39;model.nn.0.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;model.nn.1.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.1.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.5,<span class="w"> </span><span class="s1">&#39;model.nn.2.out_dim&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;model.nn.2.dropout&#39;</span>:<span class="w"> </span><span class="m">0</span>.2,<span class="w"> </span><span class="s1">&#39;training.batch_size&#39;</span>:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span><span class="s1">&#39;training.optimizer&#39;</span>:<span class="w"> </span><span class="s1">&#39;Adam&#39;</span>,<span class="w"> </span><span class="s1">&#39;training.lr&#39;</span>:<span class="w"> </span><span class="m">0</span>.0026496075439612654,<span class="w"> </span><span class="s1">&#39;training.epochs&#39;</span>:<span class="w"> </span><span class="m">7</span><span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">29</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.7125.
</span><span id="__span-13-44"><a id="__codelineno-13-44" name="__codelineno-13-44" href="#__codelineno-13-44"></a>Tuning<span class="w"> </span>results<span class="w"> </span><span class="k">for</span><span class="w"> </span>each<span class="w"> </span>run:------------------
</span><span id="__span-13-45"><a id="__codelineno-13-45" name="__codelineno-13-45" href="#__codelineno-13-45"></a>Study<span class="w"> </span>statistics<span class="w"> </span><span class="k">for</span><span class="w"> </span>run<span class="w"> </span><span class="m">0</span>:<span class="w"> </span>
</span><span id="__span-13-46"><a id="__codelineno-13-46" name="__codelineno-13-46" href="#__codelineno-13-46"></a><span class="w">  </span>Number<span class="w"> </span>of<span class="w"> </span>finished<span class="w"> </span>trials:<span class="w">  </span><span class="m">29</span>
</span><span id="__span-13-47"><a id="__codelineno-13-47" name="__codelineno-13-47" href="#__codelineno-13-47"></a><span class="w">  </span>Number<span class="w"> </span>of<span class="w"> </span>pruned<span class="w"> </span>trials:<span class="w">  </span><span class="m">0</span>
</span><span id="__span-13-48"><a id="__codelineno-13-48" name="__codelineno-13-48" href="#__codelineno-13-48"></a><span class="w">  </span>Number<span class="w"> </span>of<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>trials:<span class="w">  </span><span class="m">28</span>
</span><span id="__span-13-49"><a id="__codelineno-13-49" name="__codelineno-13-49" href="#__codelineno-13-49"></a><span class="w">  </span>Best<span class="w"> </span>trial<span class="w"> </span>value:<span class="w">  </span><span class="m">0</span>.6375
</span><span id="__span-13-50"><a id="__codelineno-13-50" name="__codelineno-13-50" href="#__codelineno-13-50"></a>Study<span class="w"> </span>statistics<span class="w"> </span><span class="k">for</span><span class="w"> </span>run<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>
</span><span id="__span-13-51"><a id="__codelineno-13-51" name="__codelineno-13-51" href="#__codelineno-13-51"></a><span class="w">  </span>Number<span class="w"> </span>of<span class="w"> </span>finished<span class="w"> </span>trials:<span class="w">  </span><span class="m">30</span>
</span><span id="__span-13-52"><a id="__codelineno-13-52" name="__codelineno-13-52" href="#__codelineno-13-52"></a><span class="w">  </span>Number<span class="w"> </span>of<span class="w"> </span>pruned<span class="w"> </span>trials:<span class="w">  </span><span class="m">0</span>
</span><span id="__span-13-53"><a id="__codelineno-13-53" name="__codelineno-13-53" href="#__codelineno-13-53"></a><span class="w">  </span>Number<span class="w"> </span>of<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>trials:<span class="w">  </span><span class="m">30</span>
</span><span id="__span-13-54"><a id="__codelineno-13-54" name="__codelineno-13-54" href="#__codelineno-13-54"></a><span class="w">  </span>Best<span class="w"> </span>trial<span class="w"> </span>value:<span class="w">  </span><span class="m">0</span>.7125
</span><span id="__span-13-55"><a id="__codelineno-13-55" name="__codelineno-13-55" href="#__codelineno-13-55"></a>Best<span class="w"> </span>trial<span class="w"> </span>global:----------------------------
</span><span id="__span-13-56"><a id="__codelineno-13-56" name="__codelineno-13-56" href="#__codelineno-13-56"></a><span class="w">  </span>Value:<span class="w">  </span><span class="m">0</span>.7125
</span><span id="__span-13-57"><a id="__codelineno-13-57" name="__codelineno-13-57" href="#__codelineno-13-57"></a><span class="w">  </span>Params:<span class="w"> </span>
</span><span id="__span-13-58"><a id="__codelineno-13-58" name="__codelineno-13-58" href="#__codelineno-13-58"></a><span class="w">    </span>model.nn.0.out_dim:<span class="w"> </span><span class="m">128</span>
</span><span id="__span-13-59"><a id="__codelineno-13-59" name="__codelineno-13-59" href="#__codelineno-13-59"></a><span class="w">    </span>model.nn.0.dropout:<span class="w"> </span><span class="m">0</span>.2
</span><span id="__span-13-60"><a id="__codelineno-13-60" name="__codelineno-13-60" href="#__codelineno-13-60"></a><span class="w">    </span>model.nn.1.out_dim:<span class="w"> </span><span class="m">32</span>
</span><span id="__span-13-61"><a id="__codelineno-13-61" name="__codelineno-13-61" href="#__codelineno-13-61"></a><span class="w">    </span>model.nn.1.dropout:<span class="w"> </span><span class="m">0</span>.5
</span><span id="__span-13-62"><a id="__codelineno-13-62" name="__codelineno-13-62" href="#__codelineno-13-62"></a><span class="w">    </span>model.nn.2.out_dim:<span class="w"> </span><span class="m">32</span>
</span><span id="__span-13-63"><a id="__codelineno-13-63" name="__codelineno-13-63" href="#__codelineno-13-63"></a><span class="w">    </span>model.nn.2.dropout:<span class="w"> </span><span class="m">0</span>.2
</span><span id="__span-13-64"><a id="__codelineno-13-64" name="__codelineno-13-64" href="#__codelineno-13-64"></a><span class="w">    </span>training.batch_size:<span class="w"> </span><span class="m">16</span>
</span><span id="__span-13-65"><a id="__codelineno-13-65" name="__codelineno-13-65" href="#__codelineno-13-65"></a><span class="w">    </span>training.optimizer:<span class="w"> </span>Adam
</span><span id="__span-13-66"><a id="__codelineno-13-66" name="__codelineno-13-66" href="#__codelineno-13-66"></a><span class="w">    </span>training.lr:<span class="w"> </span><span class="m">0</span>.0026496075439612654
</span><span id="__span-13-67"><a id="__codelineno-13-67" name="__codelineno-13-67" href="#__codelineno-13-67"></a><span class="w">    </span>training.epochs:<span class="w"> </span><span class="m">7</span>
</span><span id="__span-13-68"><a id="__codelineno-13-68" name="__codelineno-13-68" href="#__codelineno-13-68"></a>Saving<span class="w"> </span>the<span class="w"> </span>best<span class="w"> </span>configuration...
</span><span id="__span-13-69"><a id="__codelineno-13-69" name="__codelineno-13-69" href="#__codelineno-13-69"></a>Best<span class="w"> </span>configuration<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>/QuantumGrav/QuantumGravPy/docs/tmp/best_config.yaml.
</span></code></pre></div>
<h4 id="notes-on-pruner-and-parallelization">Notes on pruner and parallelization</h4>
<p>We used <a href="https://optuna.readthedocs.io/en/stable/reference/generated/optuna.pruners.MedianPruner.html">optuna.pruners.MedianPruner</a> when creating an Optuna study (<code>QGTune.tune.create_study()</code>). Support for additional pruners may be added in the future if required.</p>
<p>Although users can specify <code>n_jobs</code> (for multi-threading) when running a study optimization, we recommend keeping <code>n_jobs</code> set to <code>1</code>, according to <a href="https://optuna.readthedocs.io/en/stable/tutorial/10_key_features/004_distributed.html#multi-thread-optimization">Optuna's Multi-thread Optimization</a>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../training_a_model/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Model Training">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Model Training
              </div>
            </div>
          </a>
        
        
          
          <a href="../api/" class="md-footer__link md-footer__link--next" aria-label="Next: API documentation">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                API documentation
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "navigation.footer", "navigation.path", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "search.highlight", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>